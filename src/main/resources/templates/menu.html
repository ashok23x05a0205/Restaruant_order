<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">
<head>
    <title>TEAM-H Restaurent -> Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }
        .navbar .mx-auto {
            width: 400px;
            max-width: 90vw;
        }
        .btn-outline-primary.active {
            background-color: #0d6efd;
            color: white;
            border-color: #0d6efd;
        }
        .food-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .food-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .food-image {
            width: 200px;
            height: 160px;
            object-fit: cover;
            border-radius: 0.5rem;
        }
        .food-item-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .food-item-image {
            flex-shrink: 0;
        }
        .food-item-details {
            flex-grow: 1;
        }
        @media (max-width: 767px) {
            .food-item-row {
                flex-direction: column;
            }
            .food-image {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div layout:fragment="content">

        <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
            <div class="container">
                <a class="navbar-brand fw-bold" th:href="@{/}">Restaurant</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu" 
                        aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarMenu">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/menu}">Menu</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/orders}">My Orders</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/dashboard}">Profile</a>
                        </li>
                    </ul>

                    <form th:action="@{/menu}" method="get" class="d-flex mx-auto" role="search" style="max-width: 400px; width: 100%;">
                        <input 
                            class="form-control me-2" 
                            type="search" 
                            name="search" 
                            placeholder="Search food items..." 
                            aria-label="Search"
                            th:value="${searchKeyword}">
                        <button class="btn btn-outline-primary" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>

                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/logout}">Logout</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="row mb-4">
            <div class="col-12">
                <h2 class="display-6 fw-bold mb-0">
                    <i class="fas fa-utensils me-3 text-primary"></i>
                    Our Menu
                </h2>
                <p class="text-muted">Discover our delicious offerings</p>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title mb-3">
                            <i class="fas fa-filter me-2"></i>Filter by Category
                        </h5>
                        <div class="d-flex flex-wrap gap-2">
                            <a href="/menu" 
                               class="btn btn-outline-primary" 
                               th:classappend="${selectedCategory == null} ? ' active' : ''"
                               th:href="@{/menu(search=${searchKeyword})}">
                                <i class="fas fa-list me-1"></i>All Items
                            </a>
                            <a th:each="category : ${categories}" 
                               th:href="@{/menu(category=${category.name()}, search=${searchKeyword})}"
                               th:text="${category.name()}"
                               class="btn btn-outline-primary"
                               th:classappend="${selectedCategory == category.name()} ? ' active' : ''">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div th:if="${foodItems.empty}" class="text-center">
            <div class="card shadow-sm">
                <div class="card-body py-5">
                    <i class="fas fa-utensils fa-4x text-muted mb-3"></i>
                    <h4 class="text-muted">No Items Found</h4>
                    <p class="text-muted">No food items available in this category.</p>
                </div>
            </div>
        </div>

        <div th:if="${!foodItems.empty}" class="row g-4">
            <div th:each="item : ${foodItems}" class="col-12">
                <div class="card p-3 food-card">
                    <div class="food-item-row">
                        <div class="food-item-image">
                            <img th:src="${item.imageUrl}" th:alt="${item.name}" class="food-image" />
                        </div>

                        <div class="food-item-details">
                            <h5 th:text="${item.name}" class="fw-bold"></h5>
                            <p class="text-muted" th:text="${item.description}"></p>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <span class="h5 text-primary mb-0">
                                    $<span th:text="${item.price}"></span>
                                </span>
                                <div class="btn-group align-items-center">
                                    <a th:href="@{'/menu/' + ${item.id}}" class="btn btn-outline-primary btn-sm me-2">
                                        <i class="fas fa-eye me-1"></i>View
                                    </a>
                                    <form th:action="@{/orders/add-item}" method="post" style="display: flex; align-items: center;" class="gap-2">
                                        <input type="hidden" name="foodItemId" th:value="${item.id}" />
                                        <input type="number" name="quantity" value="1" min="1" max="99"
                                               class="form-control form-control-sm" style="width: 70px;" />
                                        <button type="submit" class="btn btn-primary btn-sm ms-2">
                                            <i class="fas fa-cart-plus me-1"></i>Order
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>                    
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
